"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,n=require("./vendor.cjs.es5.production.js");require("tty"),require("util"),require("os");var r=(null===(e=n.index)||void 0===e?void 0:e.default)||n.index||n.traverseModule,o=(null===(t=n.default_1)||void 0===t?void 0:t.default)||n.default_1||n.generateModule,i={enabled:!0,getComponentName:function(e){var t,n;return null===(n=e.split("/"))||void 0===n?void 0:null===(t=n.pop())||void 0===t?void 0:t.replace(/\.[^/.]+$/,"")},includeExtensions:[".jsx",".tsx",".js",".ts"],excludePatterns:["node_modules",".git","dist","build"],devOnly:!1};function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{file:e,line:t,column:r,component:n._object_spread({},i,o).getComponentName(e)}}function u(e){return'data-source-file="'.concat(e.file,'" data-source-line="').concat(e.line,'" data-source-component="').concat(e.component,'"')}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n._object_spread({},i,t);return!(!r.enabled||r.excludePatterns.some(function(t){return e.includes(t)}))&&!!r.includeExtensions.some(function(t){return e.endsWith(t)})}var c=function(e,t){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!a(t,u))return e;var c=n._object_spread({},i,u);return t.endsWith(".jsx")||t.endsWith(".tsx"),function(e,t,i){try{var u=n.parse_1(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy"],allowImportExportEverywhere:!0,allowReturnOutsideFunction:!0,allowSuperOutsideMethod:!0,allowUndeclaredExports:!0,strictMode:!1,allowAwaitOutsideFunction:!0});return r(u,{JSXElement:function(e){try{var r,o,u=e.node.openingElement;if(u.attributes.some(function(e){return n.libExports.isJSXAttribute(e)&&n.libExports.isJSXIdentifier(e.name)&&"data-source-file"===e.name.name}))return;var a=(null===(o=u.loc)||void 0===o?void 0:o.start.line)||1,c=s(t,a,0,i),l=[n.libExports.jsxAttribute(n.libExports.jSXIdentifier("data-source-file"),n.libExports.stringLiteral(c.file)),n.libExports.jsxAttribute(n.libExports.jSXIdentifier("data-source-line"),n.libExports.stringLiteral(c.line.toString())),n.libExports.jsxAttribute(n.libExports.jSXIdentifier("data-source-component"),n.libExports.stringLiteral(c.component))];(r=u.attributes).push.apply(r,n._to_consumable_array(l))}catch(e){console.warn("[SourceMapping] 处理JSX元素失败:",e.message)}}}),o(u,{jsescOption:{minimal:!0,quotes:"double"}},e).code}catch(n){return console.warn("[SourceMapping] AST解析失败，跳过文件 ".concat(t,":"),n.message),console.warn("[SourceMapping] 错误详情:",n),e}}(e,t,c)},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"source-mapping-injector",apply:"serve",enforce:"pre",transform:function(t,n){return c(t,n,e)}}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"ice-source-mapping-injector",setup:function(t){(0,t.onGetConfig)(function(t){"production"!==t.mode&&(t.transformPlugins=t.transformPlugins||[],t.transformPlugins.push({name:"dom-inspector-transform",transform:function(t,n){return c(t,n,e)}}))})}}},d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n._class_call_check(this,e),n._define_property(this,"options",void 0),this.options=n._object_spread({},i,t)}return n._create_class(e,[{key:"transform",value:function(e,t){return c(e,t,this.options)}},{key:"getSourceInfo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return s(e,t,n,this.options)}},{key:"generateAttributes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return u(this.getSourceInfo(e,t,n))}},{key:"shouldProcess",value:function(e){return a(e,this.options)}}]),e}();"undefined"!=typeof window&&(window.SourceMappingInjector=d),exports.DEFAULT_OPTIONS=i,exports.SourceMappingInjector=d,exports.default={viteAdapter:l,iceAdapter:p,transformCode:c,getSourceMappingInfo:s,generateSourceMappingAttributes:u,shouldProcessFile:a,SourceMappingInjector:d,DEFAULT_OPTIONS:i},exports.generateSourceMappingAttributes=u,exports.getSourceMappingInfo=s,exports.iceAdapter=p,exports.shouldProcessFile=a,exports.transformCode=c,exports.viteAdapter=l;
