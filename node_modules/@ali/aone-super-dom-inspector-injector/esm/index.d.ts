import type { DOMInspectorAPI, ViteAdapterFactory, IcePluginFactory, InjectFunction, InjectHTMLFunction } from './types';
declare const DOM_INSPECTOR_SCRIPT = "\n// DOM \u5BA1\u67E5\u5668\u811A\u672C\n(function() {\n  if (window.__domInspectorInjected) return;\n  window.__domInspectorInjected = true;\n\n  if (window.parent) {\n    window.parent.postMessage({\n      type: 'DOM_INSPECTOR_INJECTED',\n    }, '*');\n  }\n  \n  let isInspecting = false;\n  let highlightedElement = null;\n  \n  // \u521B\u5EFA\u9AD8\u4EAE\u6837\u5F0F\n  const style = document.createElement('style');\n  style.id = 'dom-inspector-style';\n  style.textContent = '.dom-inspector-highlight { outline: 3px solid #1677ff !important; outline-offset: 3px !important; background-color: rgba(22, 119, 255, 0.1) !important; } .dom-inspector-hover { outline: 3px solid #52c41a !important; outline-offset: 3px !important; cursor: crosshair !important; }';\n  document.head.appendChild(style);\n  \n  // \u83B7\u53D6\u5143\u7D20\u7684 XPath\n  function getXPath(element) {\n    if (element.id) {\n      return '//*[@id=\"' + element.id + '\"]';\n    }\n    if (element === document.body) {\n      return '/html/body';\n    }\n    let ix = 0;\n    let siblings = element.parentNode.childNodes;\n    for (let i = 0; i < siblings.length; i++) {\n      let sibling = siblings[i];\n      if (sibling === element) {\n        return getXPath(element.parentNode) + '/' + element.tagName.toLowerCase() + '[' + (ix + 1) + ']';\n      }\n      if (sibling.nodeType === 1 && sibling.tagName === element.tagName) {\n        ix++;\n      }\n    }\n  }\n  \n  // \u83B7\u53D6\u5143\u7D20\u7684 CSS \u9009\u62E9\u5668\n  function getCSSSelector(element) {\n    if (element.id) {\n      return '#' + element.id;\n    }\n    if (element.className) {\n      const classes = element.className.split(' ').filter(c => c.trim());\n      if (classes.length > 0) {\n        return element.tagName.toLowerCase() + '.' + classes.join('.');\n      }\n    }\n    return element.tagName.toLowerCase();\n  }\n  \n  // \u83B7\u53D6\u5143\u7D20\u4FE1\u606F\n  function getElementInfo(element) {\n    const attributes = {};\n    for (let i = 0; i < element.attributes.length; i++) {\n      const attr = element.attributes[i];\n      attributes[attr.name] = attr.value;\n    }\n    \n    // \u5C1D\u8BD5\u83B7\u53D6\u6E90\u7801\u6620\u5C04\u4FE1\u606F\n    let sourceInfo = null;\n    try {      \n      // \u68C0\u67E5\u662F\u5426\u6709\u6E90\u7801\u6620\u5C04\u5C5E\u6027\n      if (element.hasAttribute('data-source-file') || \n          element.hasAttribute('data-source-line') || \n          element.hasAttribute('data-source-component')) {\n        sourceInfo = {\n          file: element.getAttribute('data-source-file') || '',\n          line: parseInt(element.getAttribute('data-source-line') || '0'),\n          component: element.getAttribute('data-source-component') || '',\n          column: parseInt(element.getAttribute('data-source-column') || '0')\n        };\n      }\n      \n      // \u5982\u679C\u6CA1\u6709\u76F4\u63A5\u7684\u6E90\u7801\u6620\u5C04\uFF0C\u5C1D\u8BD5\u4ECE\u7236\u7EC4\u4EF6\u83B7\u53D6\n      if (!sourceInfo) {\n        let parent = element.parentElement;\n        let depth = 0;\n        while (parent && depth < 5) { // \u6700\u591A\u5411\u4E0A\u67E5\u627E5\u5C42\n          if (parent.hasAttribute('data-source-file')) {\n            sourceInfo = {\n              file: parent.getAttribute('data-source-file') || '',\n              line: parseInt(parent.getAttribute('data-source-line') || '0'),\n              component: parent.getAttribute('data-source-component') || '',\n              column: parseInt(parent.getAttribute('data-source-column') || '0')\n            };\n            break;\n          }\n          parent = parent.parentElement;\n          depth++;\n        }\n      }\n      \n    } catch (error) {\n      console.warn('[DomInspector] \u83B7\u53D6\u6E90\u7801\u6620\u5C04\u4FE1\u606F\u5931\u8D25:', error);\n    }\n    \n    return {\n      tagName: element.tagName.toLowerCase(),\n      className: element.className || '',\n      id: element.id || '',\n      textContent: element.textContent?.trim().substring(0, 100) || '',\n      attributes: attributes,\n      xpath: getXPath(element),\n      cssSelector: getCSSSelector(element),\n      sourceInfo: sourceInfo\n    };\n  }\n  \n  // \u9AD8\u4EAE\u5143\u7D20\n  function highlightElement(element) {\n    if (highlightedElement && highlightedElement.classList) {\n      highlightedElement.classList.remove('dom-inspector-highlight');\n    }\n    if (element && element.classList) {\n      element.classList.add('dom-inspector-highlight');\n      highlightedElement = element;\n    }\n  }\n  \n  // \u9F20\u6807\u60AC\u505C\u4E8B\u4EF6\n  function handleMouseOver(e) {\n    if (!isInspecting || !e.target) return;\n    e.stopPropagation();\n    if (e.target.classList) {\n      e.target.classList.add('dom-inspector-hover');\n    }\n  }\n  \n  // \u9F20\u6807\u79BB\u5F00\u4E8B\u4EF6\n  function handleMouseOut(e) {\n    if (!isInspecting || !e.target) return;\n    if (e.target.classList) {\n      e.target.classList.remove('dom-inspector-hover');\n    }\n  }\n  \n  // \u70B9\u51FB\u9009\u62E9\u4E8B\u4EF6\n  function handleClick(e) {\n    if (!isInspecting || !e.target) return;\n    e.preventDefault();\n    e.stopPropagation();\n    \n    const elementInfo = getElementInfo(e.target);\n    highlightElement(e.target);\n    \n    // \u83B7\u53D6\u5143\u7D20\u4F4D\u7F6E\u4FE1\u606F\n    const rect = e.target.getBoundingClientRect();\n    \n    // \u53D1\u9001\u5143\u7D20\u4FE1\u606F\u5230\u7236\u7A97\u53E3\n    if (window.parent) {\n      window.parent.postMessage({\n        type: 'ELEMENT_SELECTED',\n        data: elementInfo,\n        elementRect: {\n          x: rect.left,\n          y: rect.top,\n          width: rect.width,\n          height: rect.height,\n        }\n      }, '*');\n    }\n    \n    // \u89E6\u53D1\u81EA\u5B9A\u4E49\u4E8B\u4EF6\uFF08\u7528\u4E8E\u6D4F\u89C8\u5668\u76F4\u63A5\u5F15\u5165\uFF09\n    const event = new CustomEvent('dom-inspector:element-selected', {\n      detail: {\n        elementInfo: elementInfo,\n        elementRect: {\n          x: rect.left,\n          y: rect.top,\n          width: rect.width,\n          height: rect.height,\n        }\n      }\n    });\n    window.dispatchEvent(event);\n    \n    isInspecting = false;\n    if (document.body) {\n      document.body.style.cursor = '';\n    }\n    \n    // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\u5668\n    document.removeEventListener('mouseover', handleMouseOver, true);\n    document.removeEventListener('mouseout', handleMouseOut, true);\n    document.removeEventListener('click', handleClick, true);\n  }\n  \n  // \u5F00\u59CB\u5BA1\u67E5\u6A21\u5F0F\n  function startDOMInspection() {\n    isInspecting = true;\n    if (document.body) {\n      document.body.style.cursor = 'crosshair';\n    }\n    document.addEventListener('mouseover', handleMouseOver, true);\n    document.addEventListener('mouseout', handleMouseOut, true);\n    document.addEventListener('click', handleClick, true);\n  }\n  \n  // \u505C\u6B62\u5BA1\u67E5\u6A21\u5F0F\n  function stopDOMInspection() {\n    isInspecting = false;\n    if (document.body) {\n      document.body.style.cursor = '';\n    }\n    if (highlightedElement && highlightedElement.classList) {\n      highlightedElement.classList.remove('dom-inspector-highlight');\n      highlightedElement = null;\n    }\n    document.removeEventListener('mouseover', handleMouseOver, true);\n    document.removeEventListener('mouseout', handleMouseOut, true);\n    document.removeEventListener('click', handleClick, true);\n  }\n  \n  // \u6E05\u9664\u9AD8\u4EAE\n  function clearHighlight() {\n    \n    // \u65B9\u6CD51\uFF1A\u6E05\u9664\u5F53\u524D\u9AD8\u4EAE\u5143\u7D20\n    if (highlightedElement && highlightedElement.classList) {\n      highlightedElement.classList.remove('dom-inspector-highlight');\n      highlightedElement = null;\n    }\n    \n    // \u65B9\u6CD52\uFF1A\u6E05\u9664\u6240\u6709\u53EF\u80FD\u7684\u9AD8\u4EAE\u5143\u7D20\uFF08\u5907\u7528\u65B9\u6848\uFF09\n    const allHighlighted = document.querySelectorAll('.dom-inspector-highlight');\n\n    allHighlighted.forEach(element => {\n      element.classList.remove('dom-inspector-highlight');\n    });\n    \n    // \u65B9\u6CD53\uFF1A\u6E05\u9664\u60AC\u505C\u6837\u5F0F\n    const allHovered = document.querySelectorAll('.dom-inspector-hover');\n\n    allHovered.forEach(element => {\n      element.classList.remove('dom-inspector-hover');\n    });\n  }\n  \n  // \u76D1\u542C\u6765\u81EA\u7236\u7A97\u53E3\u7684\u6D88\u606F\n  window.addEventListener('message', function(event) {\n    if (event.source !== window.parent) {\n      return;\n    }\n    \n    switch (event.data.type) {\n      case 'START_INSPECTION':\n        startDOMInspection();\n        break;\n      case 'STOP_INSPECTION':\n        stopDOMInspection();\n        break;\n      case 'CLEAR_HIGHLIGHT':\n        clearHighlight();\n        break;\n      default:\n        break;\n    }\n  });\n  \n  // \u66B4\u9732\u5168\u5C40API\uFF08\u7528\u4E8E\u6D4F\u89C8\u5668\u76F4\u63A5\u5F15\u5165\uFF09\n  window.DOMInspector = {\n    start: startDOMInspection,\n    stop: stopDOMInspection,\n    clear: clearHighlight,\n    highlight: highlightElement,\n    getElementInfo: getElementInfo,\n    isActive: () => isInspecting\n  };\n\n})();\n";
declare const injectDOMInspectorScriptToHTML: InjectHTMLFunction;
declare const viteAdapter: ViteAdapterFactory;
declare const iceAdapter: IcePluginFactory;
declare const injectDOMInspectorScript: InjectFunction;
declare const DOMInspectorAPI: DOMInspectorAPI;
declare class DOMInspectorInjector {
    private scriptInjected;
    constructor();
    inject(): void;
    start(): void;
    stop(): void;
    clear(): void;
    isActive(): any;
    onElementSelected(callback: (detail: any) => void): () => void;
}
declare const _default: {
    viteAdapter: ViteAdapterFactory;
    iceAdapter: IcePluginFactory;
    injectDOMInspectorScriptToHTML: InjectHTMLFunction;
    injectDOMInspectorScript: InjectFunction;
    DOMInspectorAPI: DOMInspectorAPI;
    DOMInspectorInjector: typeof DOMInspectorInjector;
    DOM_INSPECTOR_SCRIPT: string;
};
export default _default;
export { viteAdapter, iceAdapter, injectDOMInspectorScriptToHTML, injectDOMInspectorScript as injectScript, DOMInspectorAPI, DOMInspectorInjector, DOM_INSPECTOR_SCRIPT };
