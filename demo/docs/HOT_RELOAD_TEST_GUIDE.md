# çƒ­æ›´æ–°åŠŸèƒ½æµ‹è¯•æŒ‡å—

## æµ‹è¯•ç¯å¢ƒ

å¼€å‘æœåŠ¡å™¨å·²ç»å¯åŠ¨åœ¨ `http://localhost:3000`

## æµ‹è¯•é¡¹ç›®

### 1. å‰ç«¯çƒ­æ›´æ–°æµ‹è¯• (HMR)

#### æµ‹è¯•æ­¥éª¤ï¼š
1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹æ§åˆ¶å°
3. ä¿®æ”¹ä»»æ„ React ç»„ä»¶æ–‡ä»¶ï¼ˆå¦‚ `src/pages/index.tsx`ï¼‰
   - ä¾‹å¦‚ï¼šä¿®æ”¹é¡µé¢æ ‡é¢˜æˆ–æ·»åŠ æ–°çš„å…ƒç´ 
4. ä¿å­˜æ–‡ä»¶

#### é¢„æœŸç»“æœï¼š
- âœ… æµè§ˆå™¨**ä¸åˆ·æ–°**çš„æƒ…å†µä¸‹ï¼Œé¡µé¢å†…å®¹ç«‹å³æ›´æ–°
- âœ… ç»„ä»¶çŠ¶æ€ä¿æŒï¼ˆReact Fast Refreshï¼‰
- âœ… æ§åˆ¶å°æ˜¾ç¤º `[vite] hot updated: /src/pages/index.tsx`

#### ç¤ºä¾‹ä¿®æ”¹ï¼š

**ä¿®æ”¹å‰** (`src/pages/index.tsx`):
```tsx
<h1>Welcome to Koa React Framework</h1>
```

**ä¿®æ”¹å**:
```tsx
<h1>Welcome to Koa React Framework - Hot Reload Test! ğŸ”¥</h1>
```

### 2. CSS çƒ­æ›´æ–°æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. è®¿é—® `http://localhost:3000/about`
2. ä¿®æ”¹ `src/styles/about.css` æ–‡ä»¶
   - ä¾‹å¦‚ï¼šä¿®æ”¹èƒŒæ™¯è‰²æˆ–å­—ä½“å¤§å°
3. ä¿å­˜æ–‡ä»¶

#### é¢„æœŸç»“æœï¼š
- âœ… æ ·å¼**ç«‹å³æ›´æ–°**ï¼Œæ— éœ€åˆ·æ–°
- âœ… é¡µé¢ä¸é—ªçƒ

#### ç¤ºä¾‹ä¿®æ”¹ï¼š

**ä¿®æ”¹å‰** (`src/styles/about.css`):
```css
.about-container {
  padding: 2rem;
}
```

**ä¿®æ”¹å**:
```css
.about-container {
  padding: 2rem;
  background-color: #f0f8ff;
}
```

### 3. åç«¯/æœåŠ¡å™¨çƒ­é‡å¯æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. è§‚å¯Ÿè¿è¡Œ `npm run dev` çš„ç»ˆç«¯
2. ä¿®æ”¹æœåŠ¡å™¨æ–‡ä»¶ï¼ˆå¦‚ `src/server/app.ts`ï¼‰
   - ä¾‹å¦‚ï¼šä¿®æ”¹æ—¥å¿—è¾“å‡ºå†…å®¹
3. ä¿å­˜æ–‡ä»¶

#### é¢„æœŸç»“æœï¼š
- âœ… ç»ˆç«¯æ˜¾ç¤º `ğŸ”„ Server restarting...`
- âœ… æœåŠ¡å™¨è‡ªåŠ¨é‡å¯ï¼ˆ1-2ç§’å†…ï¼‰
- âœ… æµè§ˆå™¨ä¸­çš„è¯·æ±‚ä¼šåœ¨é‡å¯åè‡ªåŠ¨æ¢å¤
- âœ… æ— éœ€æ‰‹åŠ¨åœæ­¢/å¯åŠ¨æœåŠ¡å™¨

#### ç¤ºä¾‹ä¿®æ”¹ï¼š

**ä¿®æ”¹å‰** (`src/server/app.ts`):
```typescript
console.log(`${ctx.method} ${ctx.path} - ${ctx.status} - ${duration}ms`);
```

**ä¿®æ”¹å**:
```typescript
console.log(`[${new Date().toISOString()}] ${ctx.method} ${ctx.path} - ${ctx.status} - ${duration}ms`);
```

### 4. API è·¯ç”±çƒ­é‡è½½æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. è§‚å¯Ÿç»ˆç«¯è¾“å‡º
2. ä¿®æ”¹ API æ–‡ä»¶ï¼ˆå¦‚ `src/api/users.ts`ï¼‰
   - ä¾‹å¦‚ï¼šä¿®æ”¹è¿”å›çš„æ•°æ®
3. ä¿å­˜æ–‡ä»¶
4. åœ¨æµè§ˆå™¨ä¸­è®¿é—® API ç«¯ç‚¹æˆ–åˆ·æ–°é¡µé¢

#### é¢„æœŸç»“æœï¼š
- âœ… ç»ˆç«¯æ˜¾ç¤º `ğŸ”„ API file changed: ...`
- âœ… æ˜¾ç¤º `â™»ï¸ Reloading API routes...`
- âœ… æ˜¾ç¤ºé‡æ–°æ³¨å†Œçš„è·¯ç”±åˆ—è¡¨
- âœ… API è¿”å›æ–°çš„æ•°æ®

#### ç¤ºä¾‹ä¿®æ”¹ï¼š

**ä¿®æ”¹å‰** (`src/api/users.ts`):
```typescript
ctx.body = {
  users: [
    { id: 1, name: 'John Doe' },
    { id: 2, name: 'Jane Smith' },
  ],
};
```

**ä¿®æ”¹å**:
```typescript
ctx.body = {
  users: [
    { id: 1, name: 'John Doe', email: 'john@example.com' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com' },
    { id: 3, name: 'Bob Wilson', email: 'bob@example.com' }, // æ–°å¢
  ],
};
```

## æ€§èƒ½å¯¹æ¯”

### æ—§æ–¹æ¡ˆï¼ˆå®Œæ•´æ„å»ºï¼‰
```bash
npm run dev:old
```
- â±ï¸ å¯åŠ¨æ—¶é—´ï¼š10-30 ç§’
- ğŸ”„ ä¿®æ”¹åéœ€è¦æ‰‹åŠ¨é‡å¯
- ğŸ“ æ¯æ¬¡éƒ½éœ€è¦å®Œæ•´æ„å»º

### æ–°æ–¹æ¡ˆï¼ˆçƒ­æ›´æ–°ï¼‰
```bash
npm run dev
```
- â±ï¸ å¯åŠ¨æ—¶é—´ï¼š< 2 ç§’
- ğŸ”„ è‡ªåŠ¨çƒ­æ›´æ–°/é‡è½½
- ğŸ“ ç›´æ¥è¿è¡Œæºç ï¼Œæ— éœ€æ„å»º

## å¸¸è§é—®é¢˜

### Q: æœåŠ¡å™¨å¯åŠ¨å¤±è´¥ï¼Ÿ
**A**: æ£€æŸ¥ç«¯å£ 3000 å’Œ 3001 æ˜¯å¦è¢«å ç”¨ï¼š
```bash
lsof -i :3000
lsof -i :3001
```

### Q: å‰ç«¯çƒ­æ›´æ–°ä¸å·¥ä½œï¼Ÿ
**A**: 
1. ç¡®ä¿ä¿®æ”¹çš„æ˜¯ `src/pages/` æˆ– `src/client.tsx` ç­‰å‰ç«¯æ–‡ä»¶
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ WebSocket è¿æ¥é”™è¯¯
3. å°è¯•åˆ·æ–°æµè§ˆå™¨

### Q: åç«¯æ²¡æœ‰è‡ªåŠ¨é‡å¯ï¼Ÿ
**A**:
1. ç¡®ä¿ nodemon æ­£ç¡®å®‰è£…
2. æ£€æŸ¥ `nodemon.json` é…ç½®æ–‡ä»¶
3. æŸ¥çœ‹ç»ˆç«¯æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q: API ä¿®æ”¹åæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ
**A**:
1. æ£€æŸ¥ç»ˆç«¯è¾“å‡ºï¼Œç¡®è®¤æ–‡ä»¶å˜åŒ–è¢«æ£€æµ‹åˆ°
2. ç­‰å¾…æœåŠ¡å™¨å®Œå…¨é‡å¯ï¼ˆçº¦1-2ç§’ï¼‰
3. åˆ·æ–°æµè§ˆå™¨æˆ–é‡æ–°å‘é€ API è¯·æ±‚

## å¼€å‘å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `npm run dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆæ–°ç‰ˆï¼Œå¸¦çƒ­æ›´æ–°ï¼‰|
| `npm run dev:verbose` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆè¯¦ç»†æ—¥å¿—ï¼‰|
| `npm run dev:old` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆæ—§ç‰ˆï¼Œå®Œæ•´æ„å»ºï¼‰|
| `npm run build` | ç”Ÿäº§æ„å»º |
| `npm run start` | å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ |
| `npm run type-check` | TypeScript ç±»å‹æ£€æŸ¥ |

## æŠ€æœ¯æ ˆ

- **å‰ç«¯çƒ­æ›´æ–°**: Vite HMR + React Fast Refresh
- **åç«¯çƒ­é‡å¯**: nodemon + tsx
- **API çƒ­é‡è½½**: chokidar + åŠ¨æ€è·¯ç”±æ›´æ–°
- **TypeScript è¿è¡Œ**: tsx (åŸºäº esbuild)

## å¼€å‘ä½“éªŒæå‡

âœ… **å¯åŠ¨é€Ÿåº¦**: ä» 10-30s â†’ < 2s  
âœ… **å‰ç«¯ä¿®æ”¹**: æ— åˆ·æ–°çƒ­æ›´æ–°  
âœ… **æ ·å¼ä¿®æ”¹**: æ— åˆ·æ–°çƒ­æ›´æ–°  
âœ… **åç«¯ä¿®æ”¹**: è‡ªåŠ¨é‡å¯ (1-2s)  
âœ… **API ä¿®æ”¹**: è‡ªåŠ¨é‡è½½ (1-2s)  
âœ… **ç±»å‹æ£€æŸ¥**: å®æ—¶åé¦ˆ  
âœ… **é”™è¯¯æç¤º**: è¯¦ç»†çš„å¼€å‘æ¨¡å¼é”™è¯¯ä¿¡æ¯  

## æ³¨æ„äº‹é¡¹

1. **å¼€å‘ç¯å¢ƒä¸“ç”¨**ï¼šæ­¤é…ç½®ä»…ç”¨äºå¼€å‘ï¼Œç”Ÿäº§ç¯å¢ƒä»ä½¿ç”¨ç¼–è¯‘åçš„ä»£ç 
2. **æ€§èƒ½æµ‹è¯•**ï¼šä¸è¦åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿›è¡Œæ€§èƒ½æµ‹è¯•
3. **WebSocket è¿æ¥**ï¼šåç«¯é‡å¯ä¼šæ–­å¼€ WebSocketï¼Œå‰ç«¯éœ€è¦å®ç°é‡è¿æœºåˆ¶
4. **æ¨¡å—ç¼“å­˜**ï¼šæŸäº›ç‰¹æ®Šæƒ…å†µä¸‹å¯èƒ½éœ€è¦å®Œå…¨é‡å¯ï¼ˆCtrl+C åé‡æ–°è¿è¡Œï¼‰

## æ•…éšœæ’æŸ¥

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å°è¯•ï¼š

1. **å®Œå…¨é‡å¯**ï¼š
```bash
# åœæ­¢å¼€å‘æœåŠ¡å™¨ (Ctrl+C)
# æ¸…ç†å¹¶é‡å¯
rm -rf node_modules/.vite
npm run dev
```

2. **å›é€€åˆ°æ—§ç‰ˆæœ¬**ï¼š
```bash
npm run dev:old
```

3. **æ£€æŸ¥æ—¥å¿—**ï¼š
```bash
npm run dev:verbose
```

## åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ `DEV_HOT_RELOAD_SOLUTION.md` æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£ã€‚

