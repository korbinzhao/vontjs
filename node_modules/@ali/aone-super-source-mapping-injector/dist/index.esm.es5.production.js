import{i as e,t as t,d as n,g as o,_ as r,p as i,l as a,a as s,b as u,c as c,e as l}from"./vendor.esm.es5.production.js";import"tty";import"util";import"os";var d=(null==e?void 0:e.default)||e||t,p=(null==n?void 0:n.default)||n||o,f={enabled:!0,getComponentName:function(e){var t,n;return null===(n=e.split("/"))||void 0===n?void 0:null===(t=n.pop())||void 0===t?void 0:t.replace(/\.[^/.]+$/,"")},includeExtensions:[".jsx",".tsx",".js",".ts"],excludePatterns:["node_modules",".git","dist","build"],devOnly:!1};function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{file:e,line:t,column:n,component:r({},f,o).getComponentName(e)}}function g(e){return'data-source-file="'.concat(e.file,'" data-source-line="').concat(e.line,'" data-source-component="').concat(e.component,'"')}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r({},f,t);return!(!n.enabled||n.excludePatterns.some(function(t){return e.includes(t)}))&&!!n.includeExtensions.some(function(t){return e.endsWith(t)})}var h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!v(t,n))return e;var o=r({},f,n);return t.endsWith(".jsx")||t.endsWith(".tsx"),function(e,t,n){try{var o=i(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy"],allowImportExportEverywhere:!0,allowReturnOutsideFunction:!0,allowSuperOutsideMethod:!0,allowUndeclaredExports:!0,strictMode:!1,allowAwaitOutsideFunction:!0});return d(o,{JSXElement:function(e){try{var o,r,i=e.node.openingElement;if(i.attributes.some(function(e){return a.isJSXAttribute(e)&&a.isJSXIdentifier(e.name)&&"data-source-file"===e.name.name}))return;var u=(null===(r=i.loc)||void 0===r?void 0:r.start.line)||1,c=m(t,u,0,n),l=[a.jsxAttribute(a.jSXIdentifier("data-source-file"),a.stringLiteral(c.file)),a.jsxAttribute(a.jSXIdentifier("data-source-line"),a.stringLiteral(c.line.toString())),a.jsxAttribute(a.jSXIdentifier("data-source-component"),a.stringLiteral(c.component))];(o=i.attributes).push.apply(o,s(l))}catch(e){console.warn("[SourceMapping] 处理JSX元素失败:",e.message)}}}),p(o,{jsescOption:{minimal:!0,quotes:"double"}},e).code}catch(n){return console.warn("[SourceMapping] AST解析失败，跳过文件 ".concat(t,":"),n.message),console.warn("[SourceMapping] 错误详情:",n),e}}(e,t,o)},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"source-mapping-injector",apply:"serve",enforce:"pre",transform:function(t,n){return h(t,n,e)}}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"ice-source-mapping-injector",setup:function(t){(0,t.onGetConfig)(function(t){"production"!==t.mode&&(t.transformPlugins=t.transformPlugins||[],t.transformPlugins.push({name:"dom-inspector-transform",transform:function(t,n){return h(t,n,e)}}))})}}},x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),l(this,"options",void 0),this.options=r({},f,t)}return u(e,[{key:"transform",value:function(e,t){return h(e,t,this.options)}},{key:"getSourceInfo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return m(e,t,n,this.options)}},{key:"generateAttributes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return g(this.getSourceInfo(e,t,n))}},{key:"shouldProcess",value:function(e){return v(e,this.options)}}]),e}();"undefined"!=typeof window&&(window.SourceMappingInjector=x);var y={viteAdapter:S,iceAdapter:j,transformCode:h,getSourceMappingInfo:m,generateSourceMappingAttributes:g,shouldProcessFile:v,SourceMappingInjector:x,DEFAULT_OPTIONS:f};export{f as DEFAULT_OPTIONS,x as SourceMappingInjector,y as default,g as generateSourceMappingAttributes,m as getSourceMappingInfo,j as iceAdapter,v as shouldProcessFile,h as transformCode,S as viteAdapter};
